(()=>{let e={},u={},t={},r=new Set,D={};self.onmessage=s=>{let{data:a}=s;if(a.init)return e=a.directMap,u=a.variantMap,t=a.patternMap,r=new Set(a.joyoList),D=a.oldNewMap,void console.log("\u25b7 worker INIT received:",{directSize:Object.keys(e).length,variantSize:Object.keys(u).length,patternSize:Object.keys(t).length});const{parts:n,mode:o,region:F}=a;if("partsToKanji"===o&&1===n.length){const u=n[0];let t=Array.isArray(e[u])?[...e[u]]:[];return t.includes(u)||t.unshift(u),"joyo"===F?t=t.filter((e=>r.has(e))):"japanese"===F&&(t=t.filter((e=>r.has(e)||D[e]))),void postMessage({results:t})}if("kanjiToParts"===o&&n.length>0){const e=[],u=new Set;return(t[n.join("")]||[]).map((e=>e.filter((e=>e.charCodeAt(0)>127)))).forEach((t=>{t.forEach((t=>{u.has(t)||(u.add(t),e.push(t))}))})),void postMessage({results:e})}const i=[];n.forEach((u=>{if(!e[u]&&t[u]){const e=t[u];e.length>0?i.push(...e[0]):i.push(u)}else i.push(u)}));const c=[...new Set(i)],l=c.map((e=>[e,...u[e]||[]])),h=l.reduce(((e,u)=>e.flatMap((e=>u.map((u=>[...e,u]))))),[[]]);const p=new Map;h.forEach((u=>{const t=u.map((u=>{const t=e[u];return new Set(Array.isArray(t)&&t.length>0?t:[u])}));if(!t.length)return;t.reduce(((e,u)=>new Set([...e].filter((e=>u.has(e)))))).forEach((e=>{p.set(e,(p.get(e)||0)+1)}))}));let f=Array.from(p.keys());"partsToKanji"===o&&("joyo"===F?f=f.filter((e=>r.has(e))):"japanese"===F&&(f=f.filter((e=>r.has(e)||D[e]))));const E=f.map((e=>({k:e,score:(t[e]||[]).reduce(((e,u)=>Math.max(e,((e,u)=>{const t=e.filter((e=>/(?:[\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u3005\u3007\u3021-\u3029\u3038-\u303B\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFA6D\uFA70-\uFAD9]|\uD81B[\uDFE2\uDFE3\uDFF0\uDFF1]|[\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])/.test(e))).length;if(!t)return 0;const r={};u.forEach((e=>r[e]=(r[e]||0)+1));let D=0;return Object.entries(r).forEach((u=>{let[t,r]=u;const s=e.reduce(((e,u)=>u===t?e+1:e),0);D+=Math.min(r,s)})),D/t*100+(e.length>=u.length&&u.every(((u,t)=>e[t]===u))?50:0)})(u,c))),0)}))).sort(((e,u)=>u.score-e.score)).slice(0,100).map((e=>e.k));postMessage({results:E})}})();
//# sourceMappingURL=676.530f2747.chunk.js.map